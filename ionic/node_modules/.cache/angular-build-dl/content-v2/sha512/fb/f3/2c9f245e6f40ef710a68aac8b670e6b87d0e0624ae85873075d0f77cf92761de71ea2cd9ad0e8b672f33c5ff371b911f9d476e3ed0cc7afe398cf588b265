{"version":3,"sources":["src/app/tab2/tab2.page.html","src/app/tab2/tab2-routing.module.ts","src/app/tab2/tab2.module.ts","src/app/tab2/tab2.page.scss","src/app/tab2/tab2.page.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<ion-header [translucent]=\\\"true\\\">\\n  <ion-toolbar>\\n    <ion-title>\\n      You are: {{userName}}\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content [fullscreen]=\\\"true\\\">\\n  <ion-list *ngFor=\\\"let usr of users\\\">\\n    <ion-item (click)=\\\"directMessageTo(usr)\\\">\\n      <ion-label>{{usr.name}}</ion-label>\\n      <ion-icon [ngStyle]=\\\"{'color':usr.color}\\\" name=\\\"alert-circle-outline\\\"></ion-icon>\\n    </ion-item>\\n  </ion-list>\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { Tab2Page } from './tab2.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: Tab2Page,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class Tab2PageRoutingModule {}\n","import { IonicModule } from '@ionic/angular';\nimport { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Tab2Page } from './tab2.page';\nimport { ExploreContainerComponentModule } from '../explore-container/explore-container.module';\n\nimport { Tab2PageRoutingModule } from './tab2-routing.module';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    ExploreContainerComponentModule,\n    Tab2PageRoutingModule\n  ],\n  declarations: [Tab2Page]\n})\nexport class Tab2PageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3RhYjIvdGFiMi5wYWdlLnNjc3MifQ== */\"","import {Component, OnInit} from '@angular/core';\nimport {ModalController} from '@ionic/angular';\nimport {AddUserComponent} from './../modals/add-user/add-user.component';\n\nimport {UsersService} from './../services/users.service';\nimport {ChatService} from './../services/chat.service';\nimport {Router} from '@angular/router';\nimport {log} from \"util\";\n\n@Component({\n    selector: 'app-tab2',\n    templateUrl: 'tab2.page.html',\n    styleUrls: ['tab2.page.scss']\n})\nexport class Tab2Page implements OnInit {\n\n    users = [];\n    hasUser: boolean = false;\n    userName: string;\n\n    constructor(private service: UsersService,\n                private chatService: ChatService,\n                public modalController: ModalController,\n                private router: Router) {\n    }\n\n    ngOnInit() {\n        // this.service.getUsers().subscribe((data: any) => {\n        //     this.users = data;\n        // }, (err: any) => {\n        //     throw new Error(err);\n        // })\n        // if not user, show prompt and create or update user with socketId\n        if (!this.hasUser) {\n            console.log('not has user');\n            // emit new user event. The server asociate the user with socketId\n            this.presentModal();\n        }\n\n        //subscribe to connected user\n        this.chatService.getConnectedUser()\n            .subscribe((user) => {\n                console.log('received from service ', user);\n                // if not user exists in usersList add\n                var existe = false;\n                for (let i = 0; i < this.users.length; i++) {\n                    var usr = this.users[i];\n                    if (user.username == usr.name) {\n                        existe = true;\n                    }\n                }\n                // validate if user is new if new so update list\n                if (!existe) {\n                    this.getUsersAndUpdate();\n                }\n            });\n    }\n\n    async presentModal() {\n        const modal = await this.modalController.create({\n            component: AddUserComponent\n        });\n        await modal.present();\n        const {data} = await modal.onWillDismiss();\n        // after create user save or update with a socket id\n        this.chatService.addOrUpdateUser(data.userName);\n        this.userName = data.userName;\n        //store user logged in localstorage\n        localStorage.setItem('userName', this.userName);\n        this.hasUser = true;\n        //update users list\n        this.getUsersAndUpdate();\n    }\n\n    directMessageTo(user) {\n        console.log('direct msg', user);\n        this.router.navigate(['/tabs/tab3'], {queryParams: {userFrom: this.userName, userTo: user.name}});\n    }\n\n    private getUsersAndUpdate() {\n        this.service.getUsers().subscribe((data: any) => {\n            this.users = data;\n            for (let i = 0; i < this.users.length; i++) {\n                var usr = this.users[i];\n                if (usr.name == this.userName) {\n                    usr.color = \"green\";\n                } else {\n                    usr.color = \"white\";\n                }\n            }\n        }, (err: any) => {\n            throw new Error(err);\n        })\n    }\n}\n"],"sourceRoot":"webpack:///","file":"tab2-tab2-module-es5.js"}